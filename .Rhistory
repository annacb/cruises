legend("topright", c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina'),
fill = c('red', 'pink', 'lightpink', 'slateblue', 'lightblue', 'lightcyan'), cex=0.8)
legend("topright", c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina'),
fill = c('red', 'pink', 'lightpink', 'royalblue', 'lightblue', 'lightcyan'), cex=0.8)
legend("topright", c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina'),
fill = c('red', 'pink', 'lightpink', 'royalblue1', 'lightblue', 'lightcyan'), cex=0.8)
colors <- c('red', 'pink', 'lightblue', 'grey90', 'skyblue1', 'skyblue1', 'skyblue1')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend("topright", c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina'),
fill = c('red', 'pink', 'lightpink', 'royalblue1', 'skyblue1', 'lightcyan'), cex=0.8)
colors <- c('red', 'pink', 'skyblue1', 'grey90', 'skyblue1', 'skyblue1', 'skyblue1')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend("topright", c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina'),
fill = c('red', 'pink', 'lightpink', 'royalblue1', 'skyblue1', 'lightcyan'), cex=0.8)
colors <- c('red', 'violet', 'skyblue1', 'grey90', 'skyblue1', 'skyblue1', 'skyblue1')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend("topright", c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina'),
fill = c('red', 'violet', 'lightpink', 'royalblue1', 'skyblue1', 'lightcyan'), cex=0.8)
colors <- c('red', 'plum1', 'skyblue1', 'grey90', 'skyblue1', 'skyblue1', 'skyblue1')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend("topright", c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina'),
fill = c('red', 'plum1', 'lightpink', 'royalblue1', 'skyblue1', 'lightcyan'), cex=0.8)
odz <- data.frame('cruise' = cruise, 'topbott' = c(200, 125, 175, 150, 150, 150, 85, 850, 950, 800, 950, 900, 1000, 1050))
colors <- c('red', 'plum1', 'skyblue1', 'grey90', 'skyblue1', 'skyblue1', 'skyblue1')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend("topright", c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina'),
fill = c('red', 'plum1', 'pink', 'royalblue1', 'skyblue1', 'lightcyan'), cex=0.8)
legend("topright", c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan'), cex=0.8)
odz <- data.frame('cruise' = cruise, 'topbott' = c(200, 125, 175, 150, 150, 150, 85, 850, 950, 800, 950, 900, 1000, 1050))
colors <- c('red', 'plum1', 'skyblue1', 'grey90', 'skyblue1', 'skyblue1', 'skyblue1')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend("topright", c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'), cex=0.8)
legend("topright", c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'))
legend(x = 2, c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'))
legend(x = 7, c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'))
cruise <- c(1:7, 1:7)
odz <- data.frame('cruise' = cruise, 'topbott' = c(200, 125, 175, 150, 150, 150, 85, 850, 950, 800, 950, 900, 1000, 1050))
colors <- c('red', 'plum1', 'skyblue1', 'grey90', 'skyblue1', 'skyblue1', 'skyblue1')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend(x = 7, c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'))
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.2, 0))
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.2, 0), bty = 'n')
colors <- c('red', 'plum1', 'skyblue1', 'grey90', 'skyblue1', 'skyblue1', 'skyblue1')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.2, 0), bty = 'n')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-1, 0), bty = 'n')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.5, 0), bty = 'n')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.4, 0), bty = 'n')
colors <- c('red', 'plum1', 'skyblue1', 'grey90', 'skyblue1', 'skyblue1', 'skyblue1')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.2, 0), bty = 'n')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n', horiz = T)
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n', horiz = T, lwd = 3)
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n', horiz = T, xpd = TRUE)
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n', horiz = T, text.width=c(0, 0.085, 0.235, 0.35))
colors <- c('red', 'plum1', 'skyblue1', 'grey90', 'skyblue1', 'skyblue1', 'skyblue1')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n', horiz = T, text.width=c(1, 1, 1, 1))
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n', text.width=c(1, 1, 1, 1))
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n')
legend(x = -5, c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n')
legend(x = 5, c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n')
colors <- c('red', 'plum1', 'skyblue1', 'grey90', 'skyblue1', 'skyblue1', 'skyblue1')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend(x = 5, c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n')
legend(x = 5, y = 5, c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n')
colors <- c('red', 'plum1', 'skyblue1', 'grey90', 'skyblue1', 'skyblue1', 'skyblue1')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend(x = 5, y = 5, c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n')
legend(x = 7, y = 5, c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend(x = 7, y = 5, c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend(x = 7.5, y = 5, c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n')
pdf('odzthickness.pdf', width = 10, height = 6)
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend(x = 7.5, y = 5, c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
inset = c(-0.3, 0), bty = 'n')
dev.off()
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend(x = 7.5, y = 5, c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = TRUE, inset = c(0, 0))
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = TRUE, inset = c(0, 0))
par(oma = c(4, 1, 1, 1))
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = TRUE, inset = c(0, 0))
par(oma = c(4, 1, 1, 1))
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = TRUE, inset = c(0, 0, 0, 0, 0, 0, 0))
dev.off()
par(oma = c(4, 1, 1, 1))
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('topright', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = TRUE, inset = c(0, 0, 0, 0, 0, 0, 0))
legend('bottom', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = TRUE, inset = c(0, 0, 0, 0, 0, 0, 0))
dev.off()
par(oma = c(4, 1, 1, 1))
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = TRUE,
inset = c(0, 0, 0, 0, 0, 0, 0), text.width=c(0, 0, 0, 0, 0, 0, 0))
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = TRUE,
inset = c(0, 0, 0, 0, 0, 0, 0), text.width=c(1, 0, 0, 0, 0, 0, 0))
dev.off()
par(oma = c(4, 1, 1, 1))
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = TRUE,
inset = c(0, 0, 0, 0, 0, 0, 0), text.width=c(1, 0, 0, 0, 0, 0, 0))
dev.off()
par(oma = c(4, 1, 1, 1))
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = TRUE,
inset = c(0, 0, 0, 0, 0, 0, 0), text.width=c(0.01, 0.01, 0, 0, 0, 0, 0))
dev.off()
par(oma = c(4, 1, 1, 1))
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = F,
inset = c(0, 0, 0, 0, 0, 0, 0), text.width=c(0.01, 0.01, 0, 0, 0, 0, 0))
dev.off()
par(oma = c(5, 1, 1, 1))
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = F,
inset = c(0, 0, 0, 0, 0, 0, 0), text.width=c(0, 0, 0, 0, 0, 0, 0))
dev.off()
par(oma = c(8, 1, 1, 1))
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = F,
inset = c(0, 0, 0, 0, 0, 0, 0), text.width=c(0, 0, 0, 0, 0, 0, 0))
dev.off()
par(oma = c(12, 1, 1, 1))
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = F,
inset = c(0, 0, 0, 0, 0, 0, 0), text.width=c(0, 0, 0, 0, 0, 0, 0))
pdf('odzthickness.pdf', width = 10, height = 6)
par(oma = c(12, 1, 1, 1))
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
par(fig = c(0, 1, 0, 1), oma = c(0, 0, 0, 0), mar = c(0, 0, 0, 0), new = TRUE)
plot(0, 0, type = "n", bty = "n", xaxt = "n", yaxt = "n")
legend('bottom', c('Strong El Nino', 'Moderate El Nino', 'Weak El Nino',
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = F,
inset = c(0, 0, 0, 0, 0, 0, 0), text.width=c(0, 0, 0, 0, 0, 0, 0))
dev.off()
pdf('odzthickness.pdf', width = 10, height = 6)
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
'Strong La Nina', 'Moderate La Nina', 'Weak La Nina', 'Neither'),
fill = c('red', 'plum1', 'mistyrose', 'royalblue1', 'skyblue1', 'lightcyan', 'grey90'),
bty = 'n', xpd = TRUE, horiz = F,
inset = c(0, 0, 0, 0, 0, 0, 0), text.width=c(0, 0, 0, 0, 0, 0, 0))
dev.off()
pdf('odzthickness.pdf', width = 10, height = 6)
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State', frame = F)
dev.off()
pdf('odzthickness.pdf', width = 10, height = 6)
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001','TGT37', 'TGT66', 'P18N', 'Clivar', 'TN278', 'SKQ'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
dev.off()
rm(list=ls())
library(reshape2)
library(ggplot2)
library(plyr)
library(scales)
library(directlabels)
horakbakk_nuts <- read.csv('horakbakker_nutrients.csv')
horakbakk_nuts2 <- subset(horakbakk_nuts, select = -c(date, time, bottDepth))
skqCTDo <- read.csv('skq16CTDo.csv')
skqCTDo2 <- subset(skqCTDo, select = -c(date, time, bottDepth))
cruisesALL0 <- rbind(horakbakk_nuts2, skqCTDo2)
skq16krognuts <- read.csv('krogslund_nuts.csv')
skq16krognuts2 <- subset(skq16krognuts, select = -c(date, time, bottDepth))
cruisesALL1 <- rbind(horakbakk_nuts2, skqCTDo2, skq16krognuts2)
cruisesALL2 <- subset(cruisesALL1, select = -c(dateNew, timeNew, datetime, press))
cruisesALL2.v2 <- subset(cruisesALL1, select = -c(dateNew, timeNew, press))
cruisesALLm.v2 <- data.frame(melt(cruisesALL2.v2, id.vars = c('cruise', 'station', 'lat', 'long', 'datetime', 'depth')))
cruisesALLn.v2 <- na.omit(cruisesALLm.v2)
stdDepths2 <- c(seq(from = 0, to = 1250, by = 10))
cruisesALLn.v2$datetime <- as.POSIXct(as.character(cruisesALLn.v2$datetime, format = c('%Y-%m-%d %H:%M')))
cruisesALLn.v2[(cruisesALLn.v2$cruise == "SKQ" & cruisesALLn.v2$variable == 'NO2' & cruisesALLn.v2$value < 0), ]$value <- 0
cruisesALLn.v2[cruisesALLn.v2$cruise == 'P18N_31DSCG94_3', ]$long <- -110
cruisesALLn.v2 <- cruisesALLn.v2[!(cruisesALLn.v2$cruise == "TN278" & cruisesALLn.v2$station == 2), ]
cruisesALLn.v2 <- cruisesALLn.v2[!(cruisesALLn.v2$cruise == "TN278" & cruisesALLn.v2$long < -111), ]
cruisesALLn.v2 <- cruisesALLn.v2[!(cruisesALLn.v2$cruise == "TN278" & cruisesALLn.v2$long > -109.5), ]
cruisesALLn.v2 <- cruisesALLn.v2[!(cruisesALLn.v2$cruise == "TN278" & cruisesALLn.v2$lat > 22.5), ]
cruisesALLn.v2 <- cruisesALLn.v2[!(cruisesALLn.v2$lat > 22.5), ]
cruisesALLn.v2 <- cruisesALLn.v2[!(cruisesALLn.v2$cruise == "SKQ" & cruisesALLn.v2$station > 10), ]
cruisesALLn.v2 <- cruisesALLn.v2[!(cruisesALLn.v2$cruise == "SKQ" & cruisesALLn.v2$station == 8), ]
skq16n <- cruisesALLn.v2[cruisesALLn.v2$cruise == 'SKQ', ]
skqmap <- unique(homz16n[, c('lat', 'long', 'datetime')])
ggplot(skqmap, aes(x = long, y = lat, label = datetime)) + geom_label() + borders('world', fill = 'white') + coord_fixed(xlim = c(-120, -90), ylim = c(8, 40))
skqmap <- unique(skq16n[, c('lat', 'long', 'datetime')])
ggplot(skqmap, aes(x = long, y = lat, label = datetime)) + geom_label() + borders('world', fill = 'white') + coord_fixed(xlim = c(-120, -90), ylim = c(8, 40))
library(maps)
allmap <-  na.omit(unique(subset(cruisesALLn.v2, select = c('cruise', 'station', 'lat', 'long', 'datetime'))))
allmap <- allmap[order(allmap$station), ]
cruisevec <- levels(allmap$cruise)
cruisevec <- cruisevec[-which(cruisevec == "")]
for(c in cruisevec){
print (c)
locCruise <- subset(allmap, cruise == c)
locplot <- ggplot(locCruise, aes(x = long, y = lat, label = datetime)) +
geom_path(arrow = arrow(angle = 15, ends = 'last')) + geom_label() + borders('world', fill = 'white') + coord_fixed(xlim = c(-120, -100), ylim = c(5, 30)) + ggtitle(c)
quartz()
print(locplot)
}
lld_interp <- function(locCruise, ndates){
# lc is one cruise
startTime <- min(as.POSIXct(locCruise$datetime))
endTime <- max(as.POSIXct(locCruise$datetime))
dateout <- round(seq(from = startTime, to = endTime, length = ndates), "day")
latout <- approx(x = as.POSIXct(locCruise$datetime), y = locCruise$lat, xout = as.POSIXct(dateout))
lonout <- approx(x = as.POSIXct(locCruise$datetime), y = locCruise$lon, xout = as.POSIXct(dateout))
return(data.frame("date" = dateout, "lat" = latout$y, "long" = lonout$y))
}
lld_interp(locCruise, 10)
for (c in cruisevec){
print (c)
## subset one cruise of interest
locCruise <- subset(allmap, cruise == c)
locCruise$datetime <- as.POSIXct(locCruise$datetime)
## interpolate down to x dates
lldLabels <- lld_interp(locCruise, 7)
locplot <- ggplot(locCruise, aes(x = long, y = lat, label = datetime)) +
borders('world', fill = 'darkolivegreen4') +
geom_text(data = lldLabels, aes(x = long, y = lat, label = date, hjust = 1.2)) +
geom_path(arrow = arrow(angle = 15, ends = 'last'), alpha = 0.7) +
geom_point(alpha = 0.7) +
coord_fixed(xlim = c(-115, -100), ylim = c(10, 25)) +
ggtitle(c)
# svg(filename = paste('transectmaps', c, '.svg'), width = 7, height = 7)
plot(locplot)
# dev.off()
}
allmap
rm(list=ls())
horakbakk_nuts <- read.csv('horakbakker_nutrients.csv')
horakbakk_nuts2 <- subset(horakbakk_nuts, select = -c(date, time, bottDepth))
skqCTDo <- read.csv('skq16CTDo.csv')
skqCTDo2 <- subset(skqCTDo, select = -c(date, time, bottDepth))
cruisesALL0 <- rbind(horakbakk_nuts2, skqCTDo2)
skq16krognuts <- read.csv('krogslund_nuts.csv')
skq16krognuts2 <- subset(skq16krognuts, select = -c(date, time, bottDepth))
cruisesALL1 <- rbind(horakbakk_nuts2, skqCTDo2, skq16krognuts2)
cruisesALL2 <- subset(cruisesALL1, select = -c(dateNew, timeNew, datetime, press))
cruisesALL2.v2 <- subset(cruisesALL1, select = -c(dateNew, timeNew, press))
cruisesALLm.v2 <- data.frame(melt(cruisesALL2.v2, id.vars = c('cruise', 'station', 'lat', 'long', 'datetime', 'depth')))
cruisesALLn.v2 <- na.omit(cruisesALLm.v2)
stdDepths2 <- c(seq(from = 0, to = 1250, by = 10))
cruisesALLn.v2$datetime <- as.POSIXct(as.character(cruisesALLn.v2$datetime, format = c('%Y-%m-%d %H:%M')))
cruisesALLn.v2[(cruisesALLn.v2$cruise == "SKQ" & cruisesALLn.v2$variable == 'NO2' & cruisesALLn.v2$value < 0), ]$value <- 0
cruisesALLn.v2[cruisesALLn.v2$cruise == 'P18N_31DSCG94_3', ]$long <- -110
cruisesALLn.v2 <- cruisesALLn.v2[!(cruisesALLn.v2$cruise == "TN278" & cruisesALLn.v2$station == 2), ]
cruisesALLn.v2 <- cruisesALLn.v2[!(cruisesALLn.v2$cruise == "TN278" & cruisesALLn.v2$long < -111), ]
cruisesALLn.v2 <- cruisesALLn.v2[!(cruisesALLn.v2$cruise == "TN278" & cruisesALLn.v2$long > -109.5), ]
cruisesALLn.v2 <- cruisesALLn.v2[!(cruisesALLn.v2$cruise == "TN278" & cruisesALLn.v2$lat > 22.5), ]
cruisesALLn.v2 <- cruisesALLn.v2[!(cruisesALLn.v2$lat > 22.5), ]
cruisesALLn.v2 <- cruisesALLn.v2[!(cruisesALLn.v2$cruise == "SKQ" & cruisesALLn.v2$station > 10), ]
cruisesALLn.v2 <- cruisesALLn.v2[!(cruisesALLn.v2$cruise == "SKQ" & cruisesALLn.v2$station == 8), ]
allmap <-  na.omit(unique(subset(cruisesALLn.v2, select = c('cruise', 'station', 'lat', 'long', 'datetime'))))
allmap <- allmap[order(allmap$station), ]
cruisevec <- levels(allmap$cruise)
cruisevec <- cruisevec[-which(cruisevec == "")]
lld_interp <- function(locCruise, ndates){
# lc is one cruise
startTime <- min(as.POSIXct(locCruise$datetime))
endTime <- max(as.POSIXct(locCruise$datetime))
dateout <- round(seq(from = startTime, to = endTime, length = ndates), "day")
latout <- approx(x = as.POSIXct(locCruise$datetime), y = locCruise$lat, xout = as.POSIXct(dateout))
lonout <- approx(x = as.POSIXct(locCruise$datetime), y = locCruise$lon, xout = as.POSIXct(dateout))
return(data.frame("date" = dateout, "lat" = latout$y, "long" = lonout$y))
}
for (c in cruisevec){
print (c)
## subset one cruise of interest
locCruise <- subset(allmap, cruise == c)
locCruise$datetime <- as.POSIXct(locCruise$datetime)
## interpolate down to x dates
lldLabels <- lld_interp(locCruise, 7)
locplot <- ggplot(locCruise, aes(x = long, y = lat, label = datetime)) +
borders('world', fill = 'darkolivegreen4') +
geom_text(data = lldLabels, aes(x = long, y = lat, label = date, hjust = 1.2)) +
geom_path(arrow = arrow(angle = 15, ends = 'last'), alpha = 0.7) +
geom_point(alpha = 0.7) +
coord_fixed(xlim = c(-115, -100), ylim = c(10, 25)) +
ggtitle(c)
# svg(filename = paste('transectmaps', c, '.svg'), width = 7, height = 7)
plot(locplot)
# dev.off()
}
allmap
for (c in cruisevec){
print (c)
## subset one cruise of interest
locCruise <- subset(allmap, cruise == c)
locCruise$datetime <- as.POSIXct(locCruise$datetime)
## interpolate down to x dates
lldLabels <- lld_interp(locCruise, 7)
locplot <- ggplot(locCruise, aes(x = long, y = lat, label = datetime)) +
borders('world', fill = 'darkolivegreen4') +
geom_text(data = lldLabels, aes(x = long, y = lat, label = date, hjust = 1.2)) +
geom_path(arrow = arrow(angle = 15, ends = 'last'), alpha = 0.7) +
geom_point(alpha = 0.7) +
coord_fixed(xlim = c(-115, -100), ylim = c(8, 24)) +
ggtitle(c)
# svg(filename = paste('transectmaps', c, '.svg'), width = 7, height = 7)
plot(locplot)
# dev.off()
}
pdf('cruisetracks.pdf', width = 6, height = 10)
for (c in cruisevec){
print (c)
## subset one cruise of interest
locCruise <- subset(allmap, cruise == c)
locCruise$datetime <- as.POSIXct(locCruise$datetime)
## interpolate down to x dates
lldLabels <- lld_interp(locCruise, 7)
locplot <- ggplot(locCruise, aes(x = long, y = lat, label = datetime)) +
borders('world', fill = 'darkolivegreen4') +
geom_text(data = lldLabels, aes(x = long, y = lat, label = date, hjust = 1.2)) +
geom_path(arrow = arrow(angle = 15, ends = 'last'), alpha = 0.7) +
geom_point(alpha = 0.7) +
coord_fixed(xlim = c(-115, -100), ylim = c(8, 24)) +
ggtitle(c)
# svg(filename = paste('transectmaps', c, '.svg'), width = 7, height = 7)
plot(locplot)
# dev.off()
}
dev.off()
cruise <- c(1:7, 1:7)
odz <- data.frame('cruise' = cruise, 'topbott' = c(200, 125, 175, 150, 150, 150, 85, 850, 950, 800, 950, 900, 1000, 1050))
colors <- c('red', 'plum1', 'skyblue1', 'grey90', 'skyblue1', 'skyblue1', 'skyblue1')
pdf('odzthickness.pdf', width = 10, height = 6)
dev.off()
pdf('odzthickness.pdf', width = 10, height = 6)
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001\ 1965','TGT37\ 1969', 'TGT66\ 1972', 'P18N\ 1994', 'Clivar\ 2007', 'TN278\ 2012', 'SKQ\ 2016-17'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
dev.off()
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001\ 1965','TGT37\ 1969', 'TGT66\ 1972', 'P18N\ 1994', 'Clivar\ 2007', 'TN278\ 2012', 'SKQ\ 2016-17'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001\n 1965','TGT37\ 1969', 'TGT66\ 1972', 'P18N\ 1994', 'Clivar\ 2007', 'TN278\ 2012', 'SKQ\ 2016-17'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
pdf('odzthickness.pdf', width = 10, height = 6)
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001\n 1965','TGT37\n 1969', 'TGT66\n 1972', 'P18N\n 1994', 'Clivar\n 2007', 'TN278\n 2012', 'SKQ\n 2016-17'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
dev.off()
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001\n 1965','TGT37\n 1969', 'TGT66\n 1972', 'P18N\n 1994', 'Clivar\n 2007', 'TN278\n 2012', 'SKQ\n 2016-17'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
cruise <- c(1:7, 1:7)
odz <- data.frame('cruise' = cruise, 'topbott' = c(200, 125, 175, 150, 150, 150, 85, 850, 950, 800, 950, 900, 1000, 1050))
colors <- c('red', 'mistyrose', 'lightcyan', 'grey90', 'lightcyan', 'lightcyan', 'lightcyan')
pdf('odzthickness.pdf', width = 10, height = 6)
dev.off()
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001\n 1965','TGT37\n 1969', 'TGT66\n 1972', 'P18N\n 1994', 'Clivar\n 2007', 'TN278\n 2012', 'SKQ\n 2016-17'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State')
boxplot(odz$topbott ~ odz$cruise, ylim = c(1100, 0), yaxs = 'i', medcol = colors, col = colors, boxcol = 'white', staplecol = 'white', names = c('TGT001\n 1965','TGT37\n 1969', 'TGT66\n 1972', 'P18N\n 1994', 'Clivar\n 2007', 'TN278\n 2012', 'SKQ\n 2016-17'), ylab = 'Depth (m)', xlab = 'Cruise', main = 'ODZ Thickness and ENSO State', text(paste("z = ", 5, sep = "")  ))
